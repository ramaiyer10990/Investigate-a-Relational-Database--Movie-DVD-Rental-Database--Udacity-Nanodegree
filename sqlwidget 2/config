{"database":"/opt/sqlwidget/dbs/dvdrental_final_2.sql","sql-evaluator-5v4ycib5hir":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true}},"sql-evaluator-ljzjlh7ciws":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"Select * FROM Film;\nSelect * FROM Actor;\nSelect * FROM Rental;","executed":true},{"query":"Select * FROM Film;\nSelect * FROM Actor;","executed":true},{"query":"Select * FROM Film;","executed":true}]},"sql-evaluator-btcllr5nc2b":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"SELECT actor_id, COUNT(film_id)\nFROM Film_actor\nGROUP BY actor_id\n","executed":true},{"query":"SELECT actor_id, COUNT(film_id)\nFROM Film_actor\nGROUP BY actor_id","executed":true},{"query":"SELECT actor_id, COUNT(film_id)\nFROM Film_actor\nGROUP BY actor_id ","executed":true},{"query":"SELECT actor_id, COUNT(film_id)\nFROM Film_actor\nGROUP BY actor_id","executed":true}]},"sql-evaluator-cm56dxzif8":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"SELECT a.first_name, \n       a.last_name,\n       a.first_name || ' ' || a.last_name AS full_name,\n       f.title ,\n       f.length\nFROM   film_actor fa\nJOIN   actor a\nON     fa.actor_id = a.actor_id\nJOIN   film f\nON     f.film_id = fa.film_id\nWHERE  f.length > 60","executed":true},{"query":"SELECT actorid, full_name, COUNT(filmtitle) film_count_peractor\nFROM\n(Select a.actor_id actorid,first_name, a.last_name,a.first_name|| ' ' ||a.last_name AS full_name, f.title filmtitle FROM\nfilm_actor fa JOIN Actor a ON fa.actor_id=a.actor_id JOIN Film f ON f.film_id=fa.film_id) t1\nGROUP BY 1,2\nORDER BY 3 DESC","executed":true},{"query":"Select a.first_name, a.last_name,a.first_name|| ' ' ||a.last_name AS full_name, f.title, f.length FROM\nfilm_actor fa JOIN Actor a ON fa.actor_id=a.actor_id JOIN Film f ON f.film_id=fa.film_id\nWHERE f.length>60","executed":true},{"query":"Select a.first_name, a.last_name,a.first_name|| ' ' ||a.last_name AS full_name, f.title, f.length FROM\nfilm_actor fa JOIN Actor a ON fa.actor_id=a.actor_id JOIN Film f ON f.film_id=fa.film_id","executed":true}]},"sql-evaluator-a0uvb88tzrm":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"SELECT DISTINCT(filmlen_groups), COUNT(title) OVER (PARTITION BY filmlen_groups) AS filmcount_bylencat\nFROM\n(SELECT\ntitle, length,\nCASE WHEN length <=60 THEN '1 hour or less'\nWHEN length >60 and length <=120 THEN 'Between 1-2 Hours'\nWHEN length >120 and length <=180 THEN 'Between 2-3 Hours' ELSE 'More than 3 Hours' END AS filmlen_groups\nFROM film) t1\nORDER BY filmlen_groups","executed":true},{"query":"SELECT full_name, filmtitle, filmlen,\nCASE WHEN filmlen <=60 THEN '1 hour or less'\nWHEN filmlen >60 and filmlen <=120 THEN 'Between 1-2 Hours'\nWHEN filmlen >120 and filmlen <=180 THEN 'Between 2-3 Hours' ELSE 'More than 3 Hours' END AS filmlen_groups\nFROM\n(SELECT a.First_name, a.Last_name, \na.first_name || ' ' || a.last_name AS full_name, f.title filmtitle, f.length filmlen\n FROM film_actor fa\n JOIN actor a\n ON fa.actor_id = a.actor_id\n JOIN Film f\n ON f.film_id=fa.film_id)t1\n ","executed":true},{"query":"SELECT a.first_name || ' ' || a.last_name AS full_name,\n       f.title ,\n       f.length\nFROM   film_actor fa\nJOIN   actor a\nON     fa.actor_id = a.actor_id\nJOIN   film f\nON     f.film_id = fa.film_id","executed":true}]},"sql-evaluator-n3fgtl3lisr":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true}},"sql-evaluator-x7byeykdx6":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"select a.category_name,\n       a.standard_Quartile,\n       count(b.rental_count) rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\ngroup by  a.category_name,\n       a.standard_Quartile\norder by a.category_name,a.standard_quartile","executed":true},{"query":"select --a.film_title,\n       a.category_name,\n       a.standard_Quartile,\n       count(b.rental_count) rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\ngroup by  a.category_name,\n       a.standard_Quartile\norder by a.category_name,a.standard_quartile\n","executed":true},{"query":"select --a.film_title,\n       a.category_name,\n       a.standard_Quartile,\n       sum(b.rental_count) rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\ngroup by  a.category_name,\n       a.standard_Quartile\norder by a.category_name,a.standard_quartile\n","executed":true},{"query":"select a.film_title,\n       a.category_name,\n       a.standard_Quartile,\n       b.rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\norder by a.category_name,a.standard_quartile\n","executed":true},{"query":"select a.film_title,\n       a.category_name,\n       a.standard_Quartile,\n       b.rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\norder by a.category_name\n","executed":true},{"query":"select a.film_title,\n       a.category_name,\n       a.standard_Quartile,\n       b.rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\n\n","executed":true},{"query":"select x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x","executed":true},{"query":"select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x","executed":true},{"query":"select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x \norder by x.category_name,NTILE(4) OVER (ORDER BY x.rental_duration)","executed":true},{"query":"select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\norder by x.category_name","executed":true},{"query":"select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n       NTILE(4) OVER (ORDER BY x.category_name,x.rental_duration) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n      -- x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_count) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n      -- x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n      -- x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration,x.rental_count) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n  ) x\n  order by x.category_name","executed":true},{"query":"select x.category_name,\n       x.rental_count,\n      -- x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration,x.rental_count) standard_Quartile\nfrom (\nselect c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\norder by c.name\n  ) x","executed":true},{"query":"select c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\norder by c.name","executed":true},{"query":"select c.name  category_name ,\n       ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY'))) rental_duration,\n       count (((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_count \nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by c.name, ((TO_DATE(TO_CHAR((e.return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((e.RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))\n","executed":true}]},"sql-evaluator-ar7lemk6ykp":{"view":{"showSchemaPanel":true,"showExportCsv":true,"showMenu":true},"history":[{"query":"SELECT DATE_PART('month', r1.rental_date) AS rental_month, \n       DATE_PART('year', r1.rental_date) AS rental_year,\n       ('Store ' || s1.store_id) AS store,\n       COUNT(*)\n  FROM store AS s1\n       JOIN staff AS s2\n        ON s1.store_id = s2.store_id\n\t\t\n       JOIN rental r1\n        ON s2.staff_id = r1.staff_id\n GROUP BY 1, 2, 3\n ORDER BY 2, 1;","executed":true},{"query":"WITH t1 AS (SELECT (first_name || ' ' || last_name) AS name, \n                   c.customer_id, \n                   p.amount, \n                   p.payment_date\n              FROM customer AS c\n                   JOIN payment AS p\n                    ON c.customer_id = p.customer_id),\n\n     t2 AS (SELECT t1.customer_id\n              FROM t1\n             GROUP BY 1\n             ORDER BY SUM(t1.amount) DESC\n             LIMIT 10),\n\n\nt3 AS (SELECT t1.name,\n              DATE_PART('month', t1.payment_date) AS payment_month, \n              DATE_PART('year', t1.payment_date) AS payment_year,\n              COUNT (*),\n              SUM(t1.amount),\n              SUM(t1.amount) AS total,\n              LEAD(SUM(t1.amount)) OVER(PARTITION BY t1.name ORDER BY DATE_PART('month', t1.payment_date)) AS lead,\n              LEAD(SUM(t1.amount)) OVER(PARTITION BY t1.name ORDER BY DATE_PART('month', t1.payment_date)) - SUM(t1.amount) AS lead_dif\n         FROM t1\n              JOIN t2\n               ON t1.customer_id = t2.customer_id\n        WHERE t1.payment_date BETWEEN '20070101' AND '20080101'\n        GROUP BY 1, 2, 3\n        ORDER BY 1, 3, 2)\n\nSELECT t3.*,\n       CASE\n           WHEN t3.lead_dif = (SELECT MAX(t3.lead_dif) FROM t3 ORDER BY 1 DESC LIMIT 1) THEN 'this is the maximum difference'\n           ELSE NULL\n           END AS is_max\t\t\t\t\t\n  FROM t3\n ORDER BY 1;","executed":true},{"query":"SELECT DATE_PART('month', r1.rental_date) AS rental_month, \n       DATE_PART('year', r1.rental_date) AS rental_year,\n       ('Store ' || s1.store_id) AS store,\n       COUNT(*)\n  FROM store AS s1\n       JOIN staff AS s2\n        ON s1.store_id = s2.store_id\n\t\t\n       JOIN rental r1\n        ON s2.staff_id = r1.staff_id\n GROUP BY 1, 2, 3\n ORDER BY 2, 1;","executed":true},{"query":"SELECT DATE_TRUNC('month', p.payment_date) pay_month, c.first_name || ' ' || c.last_name AS full_name, COUNT(p.amount) AS pay_countpermon, SUM(p.amount) AS pay_amount\nFROM customer c\nJOIN payment p\nON p.customer_id = c.customer_id\nWHERE c.first_name || ' ' || c.last_name IN\n(SELECT t1.full_name\nFROM\n(SELECT c.first_name || ' ' || c.last_name AS full_name, SUM(p.amount) as amount_total\nFROM customer c\nJOIN payment p\nON p.customer_id = c.customer_id\nGROUP BY 1\t\nORDER BY 2 DESC\nLIMIT 10) t1) AND (p.payment_date BETWEEN '2007-01-01' AND '2008-01-01')\nGROUP BY 2, 1\nORDER BY 2, 1, 3","executed":true},{"query":"SELECT t1.name, t1.standard_quartile, COUNT(t1.standard_quartile)\nFROM\n(SELECT f.title, c.name , f.rental_duration, NTILE(4) OVER (ORDER BY f.rental_duration) AS standard_quartile\nFROM film_category fc\nJOIN category c\nON c.category_id = fc.category_id\nJOIN film f\nON f.film_id = fc.film_id\nWHERE c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')) t1 \nGROUP BY 1, 2\nORDER BY 1, 2","executed":true},{"query":"select a.category_name,\n       a.standard_Quartile,\n       count(b.rental_count) rental_count\nfrom \n(select x.film_title,\n       x.category_name,\n       x.rental_duration,\n       NTILE(4) OVER (ORDER BY x.rental_duration) standard_Quartile\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       sum (((TO_DATE(TO_CHAR((return_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')) - \n(TO_DATE(TO_CHAR((RENTAL_date) ,'DD-MON-YYYY'),'DD-MON-YYYY')))) rental_duration\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) a ,\n(\nselect x.film_title,\n       x.category_name,\n       x.rental_count\nfrom (\nselect a.title film_title,\n       c.name  category_name ,\n       count(e.rental_id) rental_count\nfrom   film a,\n       film_category b,\n       category c,\n       inventory d,\n       rental e\n where a.film_id = b.film_id\n and   b.category_id = c.category_id\n and   a.film_id = d.film_id\n and   d.inventory_id = e.inventory_id\n group by a.title,c.name\n) x\n) b\nwhere a.film_title = b.film_title\nand   a.category_name = b.category_name\ngroup by  a.category_name,\n       a.standard_Quartile\norder by a.category_name,a.standard_quartile","executed":true},{"query":"SELECT t1.name, t1.standard_quartile, COUNT(t1.standard_quartile)\nFROM\n(SELECT f.title, c.name, f.rental_duration, NTILE(4) OVER (ORDER BY f.rental_duration) AS standard_quartile\n FROM\n film_category fc\n JOIN category c ON\n c.category_id = fc.category_id\n JOIN film f ON\n f.film_id = fc.film_id\n WHERE c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')) t1 \nGROUP BY 1, 2\nORDER BY 1, 2","executed":true}]}}
